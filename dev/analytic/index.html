<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Analytic Fields · ElectromagneticFields.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">ElectromagneticFields.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Analytic Fields</a><ul class="internal"><li><a class="tocitem" href="#Arnold-Beltrami-Childress-(ABC)-Field"><span>Arnold-Beltrami-Childress (ABC) Field</span></a></li><li><a class="tocitem" href="#Axisymmetric-Tokamak-Equilibrium-in-Cartesian-Coordinates"><span>Axisymmetric Tokamak Equilibrium in Cartesian Coordinates</span></a></li><li><a class="tocitem" href="#Axisymmetric-Tokamak-Equilibrium-in-Cylindrical-Coordinates"><span>Axisymmetric Tokamak Equilibrium in Cylindrical Coordinates</span></a></li><li><a class="tocitem" href="#Axisymmetric-Tokamak-Equilibrium-in-Toroidal-Coordinates"><span>Axisymmetric Tokamak Equilibrium in Toroidal Coordinates</span></a></li><li><a class="tocitem" href="#Penning-Trap-with-Uniform-Magnetic-Field"><span>Penning Trap with Uniform Magnetic Field</span></a></li><li><a class="tocitem" href="#Penning-Trap-with-Magnetic-Bottle"><span>Penning Trap with Magnetic Bottle</span></a></li><li><a class="tocitem" href="#Penning-Trap-with-Asymmetric-Magnetic-Field"><span>Penning Trap with Asymmetric Magnetic Field</span></a></li><li><a class="tocitem" href="#Singular-Magnetic-Field"><span>Singular Magnetic Field</span></a></li><li><a class="tocitem" href="#Symmetric-Magnetic-Field"><span>Symmetric Magnetic Field</span></a></li><li><a class="tocitem" href="#Symmetric-Solov&#39;ev-Equilibrium"><span>Symmetric Solov&#39;ev Equilibrium</span></a></li><li><a class="tocitem" href="#Solov&#39;ev-Equilibrium-(Antoine-Cerfon)"><span>Solov&#39;ev Equilibrium (Antoine Cerfon)</span></a></li><li><a class="tocitem" href="#Theta-Pinch"><span>Theta Pinch</span></a></li></ul></li><li><a class="tocitem" href="../modules/">Modules</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Analytic Fields</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Analytic Fields</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/DDMGNI/ElectromagneticFields.jl/blob/master/docs/src/analytic.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Analytic-Fields"><a class="docs-heading-anchor" href="#Analytic-Fields">Analytic Fields</a><a id="Analytic-Fields-1"></a><a class="docs-heading-anchor-permalink" href="#Analytic-Fields" title="Permalink"></a></h1><h2 id="Arnold-Beltrami-Childress-(ABC)-Field"><a class="docs-heading-anchor" href="#Arnold-Beltrami-Childress-(ABC)-Field">Arnold-Beltrami-Childress (ABC) Field</a><a id="Arnold-Beltrami-Childress-(ABC)-Field-1"></a><a class="docs-heading-anchor-permalink" href="#Arnold-Beltrami-Childress-(ABC)-Field" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ElectromagneticFields.ABC" href="#ElectromagneticFields.ABC"><code>ElectromagneticFields.ABC</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Arnold-Beltrami-Childress (ABC) field in (x,y,z) coordinates with covariant components of the vector potential given by</p><div>\[A (x,y,z) = \big( a \, \sin(z) + c \, \cos(y) , \, b \, \sin(x) + a \, \cos(z) , \, c \, \sin(y) + b \, \cos(x) \big)^T\]</div><p>resulting in the magnetic field <span>$B(x,y,z) = A(x,y,z)$</span>.</p><p>Parameters: <code>a</code>, <code>b</code>, <code>c</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/ElectromagneticFields.jl/blob/56ffa5c7b3d5839dec8fec88d1a2094055a27f49/src/analytic/abc.jl#L1-L10">source</a></section></article><p>Absolut value of the magnetic field:</p><p><img src="../abc.png" alt/></p><h2 id="Axisymmetric-Tokamak-Equilibrium-in-Cartesian-Coordinates"><a class="docs-heading-anchor" href="#Axisymmetric-Tokamak-Equilibrium-in-Cartesian-Coordinates">Axisymmetric Tokamak Equilibrium in Cartesian Coordinates</a><a id="Axisymmetric-Tokamak-Equilibrium-in-Cartesian-Coordinates-1"></a><a class="docs-heading-anchor-permalink" href="#Axisymmetric-Tokamak-Equilibrium-in-Cartesian-Coordinates" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ElectromagneticFields.AxisymmetricTokamakCartesian" href="#ElectromagneticFields.AxisymmetricTokamakCartesian"><code>ElectromagneticFields.AxisymmetricTokamakCartesian</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Axisymmetric tokamak equilibrium in (x,y,z) coordinates with covariant components of the vector potential given by</p><div>\[A (x,y,z) = \frac{1}{2} \frac{B_0}{q_0} \, \bigg( \frac{q_0 R_0 x z - r^2 y}{R^2} , \, \frac{q_0 R_0 y z + r^2 x}{R^2} , \, - q_0 R_0 \, \ln \bigg( \frac{R}{R_0} \bigg) \bigg)^T ,\]</div><p>resulting in the magnetic field with covariant components</p><div>\[B (x,y,z) = \frac{B_0}{q_0} \, \bigg( - \frac{q_0 R_0 y + x z}{R^2} , \, \frac{q_0 R_0 x - y z}{R^2} , \, \frac{R - R_0}{R} \bigg)^T ,\]</div><p>where <span>$R = \sqrt{ x^2 + y^2 }$</span> and <span>$r = \sqrt{ (R - R_0)^2 + z^2 }$</span>.</p><p>Parameters:</p><ul><li><code>R₀</code>: position of magnetic axis</li><li><code>B₀</code>: B-field at magnetic axis</li><li><code>q₀</code>: safety factor at magnetic axis</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/ElectromagneticFields.jl/blob/56ffa5c7b3d5839dec8fec88d1a2094055a27f49/src/analytic/axisymmetric_tokamak_cartesian.jl#L1-L17">source</a></section></article><p>Vector potential in y direction:</p><p><img src="../axisymmetric_tokamak_cartesian.png" alt/></p><h2 id="Axisymmetric-Tokamak-Equilibrium-in-Cylindrical-Coordinates"><a class="docs-heading-anchor" href="#Axisymmetric-Tokamak-Equilibrium-in-Cylindrical-Coordinates">Axisymmetric Tokamak Equilibrium in Cylindrical Coordinates</a><a id="Axisymmetric-Tokamak-Equilibrium-in-Cylindrical-Coordinates-1"></a><a class="docs-heading-anchor-permalink" href="#Axisymmetric-Tokamak-Equilibrium-in-Cylindrical-Coordinates" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ElectromagneticFields.AxisymmetricTokamakCylindrical" href="#ElectromagneticFields.AxisymmetricTokamakCylindrical"><code>ElectromagneticFields.AxisymmetricTokamakCylindrical</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Axisymmetric tokamak equilibrium in (R,Z,ϕ) coordinates with covariant components of the vector potential given by</p><div>\[A (R, Z, \phi) = \frac{B_0}{2} \, \bigg( R_0 \, \frac{Z}{R} , \, - R_0 \, \ln \bigg( \frac{R}{R_0} \bigg) , \, - \frac{r^2}{q_0} \bigg)^T ,\]</div><p>resulting in the magnetic field with covariant components</p><div>\[B (R, Z, \phi) = \frac{B_0}{q_0} \, \bigg( - \frac{Z}{R} , \, \frac{R - R_0}{R} , \, - q_0 R_0 \bigg)^T ,\]</div><p>where <span>$r = \sqrt{ (R - R_0)^2 + Z^2 }$</span>.</p><p>Parameters:</p><ul><li><code>R₀</code>: position of magnetic axis</li><li><code>B₀</code>: B-field at magnetic axis</li><li><code>q₀</code>: safety factor at magnetic axis</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/ElectromagneticFields.jl/blob/56ffa5c7b3d5839dec8fec88d1a2094055a27f49/src/analytic/axisymmetric_tokamak_cylindrical.jl#L1-L17">source</a></section></article><p>Vector potential in y direction:</p><p><img src="../axisymmetric_tokamak_cylindrical.png" alt/></p><h2 id="Axisymmetric-Tokamak-Equilibrium-in-Toroidal-Coordinates"><a class="docs-heading-anchor" href="#Axisymmetric-Tokamak-Equilibrium-in-Toroidal-Coordinates">Axisymmetric Tokamak Equilibrium in Toroidal Coordinates</a><a id="Axisymmetric-Tokamak-Equilibrium-in-Toroidal-Coordinates-1"></a><a class="docs-heading-anchor-permalink" href="#Axisymmetric-Tokamak-Equilibrium-in-Toroidal-Coordinates" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ElectromagneticFields.AxisymmetricTokamakToroidal" href="#ElectromagneticFields.AxisymmetricTokamakToroidal"><code>ElectromagneticFields.AxisymmetricTokamakToroidal</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Axisymmetric tokamak equilibrium in (r,θ,ϕ) coordinates with covariant components of the vector potential given by</p><div>\[A (r, \theta, \phi) = B_0 \, \bigg( 0 , \, \frac{r R_0}{\cos (\theta)} - \bigg( \frac{R_0}{\cos (\theta)} \bigg)^2 \, \ln \bigg( \frac{R}{R_0} \bigg) , \, - \frac{r^2}{2 q_0} \bigg)^T ,\]</div><p>resulting in the magnetic field with covariant components</p><div>\[B (r, \theta, \phi) = \frac{B_0}{q_0} \, \bigg( 0 , \, \frac{r^2}{R}, \, q_0 R_0 \bigg)^T ,\]</div><p>where <span>$R = R_0 + r \cos \theta$</span>.</p><p>Parameters:</p><ul><li><code>R₀</code>: position of magnetic axis</li><li><code>B₀</code>: B-field at magnetic axis</li><li><code>q₀</code>: safety factor at magnetic axis</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/ElectromagneticFields.jl/blob/56ffa5c7b3d5839dec8fec88d1a2094055a27f49/src/analytic/axisymmetric_tokamak_toroidal.jl#L1-L17">source</a></section></article><p>Vector potential in y direction:</p><p><img src="../axisymmetric_tokamak_toroidal.png" alt/></p><h2 id="Penning-Trap-with-Uniform-Magnetic-Field"><a class="docs-heading-anchor" href="#Penning-Trap-with-Uniform-Magnetic-Field">Penning Trap with Uniform Magnetic Field</a><a id="Penning-Trap-with-Uniform-Magnetic-Field-1"></a><a class="docs-heading-anchor-permalink" href="#Penning-Trap-with-Uniform-Magnetic-Field" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ElectromagneticFields.PenningTrapUniform" href="#ElectromagneticFields.PenningTrapUniform"><code>ElectromagneticFields.PenningTrapUniform</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Penning trap with uniform magnetic field in (x,y,z) coordinates. Based on Yanyan Shi, Yajuan Sun, Yulei Wang, Jian Liu, Study of adaptive symplectic methods for       simulating charged particle dynamics, Journal of Computational Dynamics 6, 429-448, 2019.</p><p>The covariant components of the vector potential are given by</p><div>\[A (x,y,z) = B_0 \, ( 0, x, 0)^T ,\]</div><p>resulting in the magnetic field with covariant components</p><div>\[B (x,y,z) = B_0 \, ( 0, 0, 1)^T ,\]</div><p>and the electrostatic potential given by</p><div>\[\varphi (x,y,z) = E_0 \, ( x^2 / 2 + y^2 / 2 - z^2) ,\]</div><p>resulting in the electric field with covariant components</p><div>\[E (x,y,z) = E_0 \, ( x, y, - 2 z)^T .\]</div><p>Parameters:</p><ul><li><code>B₀</code>: B-field strength</li><li><code>E₀</code>: E-field strength</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/ElectromagneticFields.jl/blob/56ffa5c7b3d5839dec8fec88d1a2094055a27f49/src/analytic/penning_trap_uniform.jl#L1-L26">source</a></section></article><h2 id="Penning-Trap-with-Magnetic-Bottle"><a class="docs-heading-anchor" href="#Penning-Trap-with-Magnetic-Bottle">Penning Trap with Magnetic Bottle</a><a id="Penning-Trap-with-Magnetic-Bottle-1"></a><a class="docs-heading-anchor-permalink" href="#Penning-Trap-with-Magnetic-Bottle" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ElectromagneticFields.PenningTrapBottle" href="#ElectromagneticFields.PenningTrapBottle"><code>ElectromagneticFields.PenningTrapBottle</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Penning trap with magnetic bottle in (x,y,z) coordinates. Based on Yanyan Shi, Yajuan Sun, Yulei Wang, Jian Liu, Study of adaptive symplectic methods for       simulating charged particle dynamics, Journal of Computational Dynamics 6, 429-448, 2019.</p><p>The covariant components of the vector potential are given by</p><div>\[A (x,y,z) = B_0 / 2 \, ( -y , x, 0)^T - B_1 \, (xz, yz, (x^2 + y^2)/2 - z^2)^T,\]</div><p>resulting in the magnetic field with covariant components</p><div>\[B (x,y,z) = B_0 \, ( 0, 0, 1)^T - B_1 \, ( yz^2 - y^3 / 6, x^3 / 6, xyz )^T ,\]</div><p>and the electrostatic potential given by</p><div>\[\varphi (x,y,z) = E_0 \, ( x^2 / 2 + y^2 / 2 - z^2) ,\]</div><p>resulting in the electric field with covariant components</p><div>\[E (x,y,z) = E_0 \, ( x, y, - 2 z)^T .\]</div><p>Parameters:</p><ul><li><code>B₀</code>: B-field strength</li><li><code>Bₚ</code>: B-field perturbation strength</li><li><code>E₀</code>: E-field strength</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/ElectromagneticFields.jl/blob/56ffa5c7b3d5839dec8fec88d1a2094055a27f49/src/analytic/penning_trap_bottle.jl#L1-L27">source</a></section></article><h2 id="Penning-Trap-with-Asymmetric-Magnetic-Field"><a class="docs-heading-anchor" href="#Penning-Trap-with-Asymmetric-Magnetic-Field">Penning Trap with Asymmetric Magnetic Field</a><a id="Penning-Trap-with-Asymmetric-Magnetic-Field-1"></a><a class="docs-heading-anchor-permalink" href="#Penning-Trap-with-Asymmetric-Magnetic-Field" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ElectromagneticFields.PenningTrapAsymmetric" href="#ElectromagneticFields.PenningTrapAsymmetric"><code>ElectromagneticFields.PenningTrapAsymmetric</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Penning trap with asymmetric magnetic field in (x,y,z) coordinates. Based on Yanyan Shi, Yajuan Sun, Yulei Wang, Jian Liu, Study of adaptive symplectic methods for       simulating charged particle dynamics, Journal of Computational Dynamics 6, 429-448, 2019.</p><p>The covariant components of the vector potential are given by</p><div>\[A (x,y,z) = B_0 / 2 \, ( -y , x-z/6, y / 6)^T + B_1 / 2 \, (z^2 - y^2, z^2 - x^2, y^2 - x^2)^T,\]</div><p>resulting in the magnetic field with covariant components</p><div>\[B (x,y,z) = B_0 \, ( 1/3, 0, 1)^T + B_1 \, ( y-z, x+z, y-x )^T ,\]</div><p>and the electrostatic potential given by</p><div>\[\varphi (x,y,z) = E_0 \, ( x^2 / 2 + y^2 / 2 - z^2) ,\]</div><p>resulting in the electric field with covariant components</p><div>\[E (x,y,z) = E_0 \, ( x, y, - 2 z)^T .\]</div><p>Parameters:</p><ul><li><code>B₀</code>: B-field strength</li><li><code>Bₚ</code>: B-field perturbation strength</li><li><code>E₀</code>: E-field strength</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/ElectromagneticFields.jl/blob/56ffa5c7b3d5839dec8fec88d1a2094055a27f49/src/analytic/penning_trap_asymmetric.jl#L1-L27">source</a></section></article><h2 id="Singular-Magnetic-Field"><a class="docs-heading-anchor" href="#Singular-Magnetic-Field">Singular Magnetic Field</a><a id="Singular-Magnetic-Field-1"></a><a class="docs-heading-anchor-permalink" href="#Singular-Magnetic-Field" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ElectromagneticFields.Singular" href="#ElectromagneticFields.Singular"><code>ElectromagneticFields.Singular</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Singular magnetic field in (x,y,z) coordinates with covariant components of the vector potential given by</p><div>\[A (x,y,z) = \frac{B_0}{\sqrt{(x^2 + y^2)}^3} \big( y , \, - x , \, 0 \big)^T\]</div><p>resulting in the magnetic field with covariant components</p><div>\[B(x,y,z) = B_0 \, \begin{pmatrix}
0 \\
0 \\
(x^2 + y^2)^{-3/2} \\
\end{pmatrix}\]</div><p>Parameters: <code>B₀</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/ElectromagneticFields.jl/blob/56ffa5c7b3d5839dec8fec88d1a2094055a27f49/src/analytic/singular.jl#L1-L17">source</a></section></article><p>Vector potential and magnetic field components:</p><p><img src="../singular.png" alt/></p><h2 id="Symmetric-Magnetic-Field"><a class="docs-heading-anchor" href="#Symmetric-Magnetic-Field">Symmetric Magnetic Field</a><a id="Symmetric-Magnetic-Field-1"></a><a class="docs-heading-anchor-permalink" href="#Symmetric-Magnetic-Field" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ElectromagneticFields.SymmetricQuadratic" href="#ElectromagneticFields.SymmetricQuadratic"><code>ElectromagneticFields.SymmetricQuadratic</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Symmetric quadratic mangetic field in (x,y,z) coordinates with covariant components of the vector potential given by</p><div>\[A (x,y,z) = \frac{B_0}{4} \big( - y \, (2 + x^2 + y^2) , \, x \, (2 + x^2 + y^2) , \, 0 \big)^T\]</div><p>resulting in the magnetic field with covariant components</p><div>\[B(x,y,z) = B_0 \, \begin{pmatrix}
0 \\
0 \\
1 + x^2 + y^2 \\
\end{pmatrix}\]</div><p>Parameters: <code>B₀</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/ElectromagneticFields.jl/blob/56ffa5c7b3d5839dec8fec88d1a2094055a27f49/src/analytic/symmetric_quadratic.jl#L1-L17">source</a></section></article><p>Vector potential and magnetic field components:</p><p><img src="../symmetric.png" alt/></p><h2 id="Symmetric-Solov&#39;ev-Equilibrium"><a class="docs-heading-anchor" href="#Symmetric-Solov&#39;ev-Equilibrium">Symmetric Solov&#39;ev Equilibrium</a><a id="Symmetric-Solov&#39;ev-Equilibrium-1"></a><a class="docs-heading-anchor-permalink" href="#Symmetric-Solov&#39;ev-Equilibrium" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ElectromagneticFields.SolovevSymmetric" href="#ElectromagneticFields.SolovevSymmetric"><code>ElectromagneticFields.SolovevSymmetric</code></a> — <span class="docstring-category">Module</span></header><section><div><p>Symmetric Solov&#39;ev equilibrium in (R,Z,phi) coordinates. Based on McCarthy, Physics of Plasmas 6, 3554, 1999.</p><p>The covariant components of the vector potential are given by</p><div>\[A (x, y) = \frac{B_0}{2} \, \bigg( 0 , \, 0 , \, - \frac{\alpha}{4} (R_0 + x)^4 - \beta y^2 \bigg)^T ,\]</div><p>Parameters:</p><ul><li><code>R₀</code>: position of magnetic axis</li><li><code>B₀</code>: B-field at magnetic axis</li><li><code>α</code>, <code>β</code>: free constants</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/ElectromagneticFields.jl/blob/56ffa5c7b3d5839dec8fec88d1a2094055a27f49/src/analytic/solovev_symmetric.jl#L1-L14">source</a></section></article><p>Vector potential in z direction:</p><p><img src="../solovev_symmetric.png" alt/></p><h2 id="Solov&#39;ev-Equilibrium-(Antoine-Cerfon)"><a class="docs-heading-anchor" href="#Solov&#39;ev-Equilibrium-(Antoine-Cerfon)">Solov&#39;ev Equilibrium (Antoine Cerfon)</a><a id="Solov&#39;ev-Equilibrium-(Antoine-Cerfon)-1"></a><a class="docs-heading-anchor-permalink" href="#Solov&#39;ev-Equilibrium-(Antoine-Cerfon)" title="Permalink"></a></h2><h3 id="Solov&#39;ev-Equilibrium-up/down-symmetric"><a class="docs-heading-anchor" href="#Solov&#39;ev-Equilibrium-up/down-symmetric">Solov&#39;ev Equilibrium up/down symmetric</a><a id="Solov&#39;ev-Equilibrium-up/down-symmetric-1"></a><a class="docs-heading-anchor-permalink" href="#Solov&#39;ev-Equilibrium-up/down-symmetric" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ElectromagneticFields.Solovev.SolovevEquilibrium" href="#ElectromagneticFields.Solovev.SolovevEquilibrium"><code>ElectromagneticFields.Solovev.SolovevEquilibrium</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Axisymmetric Solov&#39;ev equilibra in (R/R₀,Z/R₀,ϕ) coordinates. Based on Cerfon &amp; Freidberg, Physics of Plasmas 17, 032502, 2010,     and Freidberg, Ideal Magnetohydrodynamics, 2014.</p><p>The covariant components of the vector potential are given by</p><div>\[A (x, y, \phi) = \left( \frac{B_0 R_0}{2} \, \frac{y}{x} , \, - \frac{B_0 R_0}{2} \, \ln x , \, \psi(x,y) \right)^T ,\]</div><p>with <span>$x = R/R_0$</span> and <span>$y = Z/R_0$</span>. The normalised poloidal flux <span>$\psi$</span> is given by</p><div>\[\psi (x,y) = \psi_0 + \sum \limits_{i=1}^{7} c_i \psi_i (x,y) ,\]</div><p>with</p><div>\[\begin{aligned}
\psi_{0} &amp;= \frac{x^4}{8} + \alpha \left( \frac{1}{2} x^2 \, \ln x - \frac{x^4}{8} \right) , \\
\psi_{1} &amp;= 1 , \\
\psi_{2} &amp;= x^2 , \\
\psi_{3} &amp;= y^2 - x^2 \, \ln x , \\
\psi_{4} &amp;= x^4 - 4 x^2 y^2 , \\
\psi_{5} &amp;= 2 y^4 9 y^2 x^2 + 3 x^4 \, \ln x - 12 x^2 y^2 \, \ln x , \\
\psi_{6} &amp;= x^6 - 12 x^4 y^2 + 8 x^2 y^4 , \\
\psi_{7} &amp;= 8 y^6 - 140 y^4 x^2 + 75 y^2 x^4 - 15 x^6 \, \ln x + 180 x^4 y^2 \, \ln x - 120 x^2 y^4 \, \ln x .
\end{aligned}\]</div><p>This formula describes exact solutions of the Grad-Shafranov equation with up-down symmetry. The constants <span>$c_i$</span> are determined from boundary constraints on <span>$\psi$</span>, that are derived from the following analytic model for a smooth, elongated &quot;D&quot; shaped cross section:</p><div>\[\begin{aligned}
x &amp;= 1 + \epsilon \, \cos (\tau + \delta_0 \, \sin \tau) , \\
y &amp;= \epsilon \kappa \, \sin (\tau) ,
\end{aligned}\]</div><p>where <span>$0 \leq \tau &lt; 2 \pi$</span>, <span>$\epsilon = a / R_0$</span> is the inverse aspect ratio, <span>$\kappa$</span> the elongation, and <span>$\sin \delta_0 = \delta$</span> is the triangularity.</p><p>Defining three test points, namely</p><ul><li>the high point <span>$(1 - \delta \epsilon, \kappa \epsilon)$</span>,</li><li>the inner equatorial point <span>$(1 - \epsilon, 0)$</span>,</li><li>and the outer equatorial point <span>$(1 + \epsilon, 0)$</span>,</li></ul><p>the following geometric constraints can be posed on the solution:</p><div>\[\begin{aligned}
\psi (1 + \epsilon, 0) &amp;= 0 , \\
\psi (1 - \epsilon, 0) &amp;= 0 , \\
\psi (1 - \delta \epsilon, \kappa \epsilon) &amp;= 0 , \\
\psi_{x} (1 - \delta \epsilon, \kappa \epsilon) &amp;= 0 , \\
\psi_{yy} (1 + \epsilon, 0) &amp;= - N_1 \psi_{x} (1 + \epsilon, 0) , \\
\psi_{yy} (1 - \epsilon, 0) &amp;= - N_2 \psi_{x} (1 - \epsilon, 0) , \\
\psi_{xx} (1 - \delta \epsilon, \kappa \epsilon) &amp;= - N_3 \psi_y (1 - \delta \epsilon, \kappa \epsilon) .
\end{aligned}\]</div><p>The first three equations define the three test points, the fourth equations enforces the high point to be a maximum, and the last three equations define the curvature at the test points.</p><p>The coefficients <span>$N_j$</span> can be found from the analytic model cross section as</p><div>\[\begin{aligned}
N_1 &amp;= \left[ \frac{d^2 x}{dy^2} \right]_{\tau = 0}     = - \frac{(1 + \delta_0)^2}{\epsilon \kappa^2} , \\
N_2 &amp;= \left[ \frac{d^2 x}{dy^2} \right]_{\tau = \pi}   = \hphantom{-} \frac{(1 - \delta_0)^2}{\epsilon \kappa^2} , \\
N_3 &amp;= \left[ \frac{d^2 x}{dy^2} \right]_{\tau = \pi/2} = - \frac{\kappa}{\epsilon \, \cos^2 \delta_0} .
\end{aligned}\]</div><p>For a given value of the constant <span>$a$</span> above conditions reduce to a set of seven linear inhomogeneous algebraic equations for the unknown <span>$c_i$</span>, which can easily be solved.</p><p>Parameters:</p><ul><li><code>R₀</code>: position of magnetic axis</li><li><code>B₀</code>: B-field at magnetic axis</li><li><code>ϵ</code>:  inverse aspect ratio</li><li><code>κ</code>:  elongation</li><li><code>δ</code>:  triangularity</li><li><code>α</code>:  free constant, determined to match a given beta value</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/ElectromagneticFields.jl/blob/56ffa5c7b3d5839dec8fec88d1a2094055a27f49/src/analytic/solovev.jl#L74-L157">source</a></section></article><p>Vector potential in ITER, NSTX and a field reversed configuration:</p><p><img src="../solovev.png" alt/></p><h3 id="Solov&#39;ev-Equilibrium-with-X-Point"><a class="docs-heading-anchor" href="#Solov&#39;ev-Equilibrium-with-X-Point">Solov&#39;ev Equilibrium with X-Point</a><a id="Solov&#39;ev-Equilibrium-with-X-Point-1"></a><a class="docs-heading-anchor-permalink" href="#Solov&#39;ev-Equilibrium-with-X-Point" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="ElectromagneticFields.Solovev.SolovevXpointEquilibrium" href="#ElectromagneticFields.Solovev.SolovevXpointEquilibrium"><code>ElectromagneticFields.Solovev.SolovevXpointEquilibrium</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Axisymmetric Solov&#39;ev equilibra with X-point in (R/R₀,Z/R₀,phi) coordinates. Based on Cerfon &amp; Freidberg, Physics of Plasmas 17, 032502, 2010,     and Freidberg, Ideal Magnetohydrodynamics, 2014.</p><p>The covariant components of the vector potential are given by</p><div>\[A (x, y, \phi) = \left( \frac{B_0 R_0}{2} \, \frac{y}{x} , \, - \frac{B_0 R_0}{2} \, \ln x , \, \psi(x,y) \right)^T ,\]</div><p>with <span>$x = R/R_0$</span> and <span>$y = Z/R_0$</span>. The normalised poloidal flux <span>$\psi$</span> is given by</p><div>\[\psi (x,y) = \psi_0 + \sum \limits_{i=1}^{12} c_i \psi_i (x,y) ,\]</div><p>with</p><div>\[\begin{aligned}
\psi_{0}  &amp;= \frac{x^4}{8} + \alpha \left( \frac{1}{2} x^2 \, \ln x - \frac{x^4}{8} \right) , \\
\psi_{1}  &amp;= 1 , \\
\psi_{2}  &amp;= x^2 , \\
\psi_{3}  &amp;= y^2 - x^2 \, \ln x , \\
\psi_{4}  &amp;= x^4 - 4 x^2 y^2 , \\
\psi_{5}  &amp;= 2 y^4 9 y^2 x^2 + 3 x^4 \, \ln x - 12 x^2 y^2 \, \ln x , \\
\psi_{6}  &amp;= x^6 - 12 x^4 y^2 + 8 x^2 y^4 , \\
\psi_{7}  &amp;= 8 y^6 - 140 y^4 x^2 + 75 y^2 x^4 - 15 x^6 \, \ln x + 180 x^4 y^2 \, \ln x - 120 x^2 y^4 \, \ln x , \\
\psi_{8}  &amp;= y , \\
\psi_{9}  &amp;= y x^2 , \\
\psi_{10} &amp;= y^3 - 3 y x^2 \, \ln x , \\
\psi_{11} &amp;= 3 y x^4 - 4 y^3 x^2 , \\
\psi_{12} &amp;= 8 y^5 - 45 y x^4 - 80 y^3 x^2 \, \ln x + 60 y x^4 \, \ln x .
\end{aligned}\]</div><p>This formula describes exact solutions of the Grad-Shafranov equation with up-down asymmetry. The constants <span>$c_i$</span> are determined from boundary constraints on <span>$\psi$</span>, that are derived from the following analytic model for a smooth, elongated &quot;D&quot; shaped cross section:</p><div>\[\begin{aligned}
x &amp;= 1 + \epsilon \, \cos (\tau + \arcsin \delta \, \sin \tau) , \\
y &amp;= \epsilon \kappa \, \sin (\tau) ,
\end{aligned}\]</div><p>where <span>$0 \leq \tau &lt; 2 \pi$</span>, <span>$\epsilon = a / R_0$</span> is the inverse aspect ratio, <span>$\kappa$</span> the elongation, and <span>$\sin \delta_0 = \delta$</span> is the triangularity.</p><p>Defining four test points, namely</p><ul><li>the high point <span>$(1 - \delta \epsilon, \kappa \epsilon)$</span>,</li><li>the inner equatorial point <span>$(1 - \epsilon, 0)$</span>,</li><li>and the outer equatorial point <span>$(1 + \epsilon, 0)$</span>,</li><li>the position of the X-point <span>$(x_{\mathrm{sep}}, y_{\mathrm{sep}})$</span>,</li></ul><p>the following geometric constraints can be posed on the solution:</p><div>\[\begin{aligned}
\psi (1 + \epsilon, 0) &amp;= 0 , \\
\psi (1 - \epsilon, 0) &amp;= 0 , \\
\psi (1 - \delta \epsilon, \kappa \epsilon) &amp;= 0 , \\
\psi (x_{\mathrm{sep}}, y_{\mathrm{sep}}) &amp;= 0 , \\
\psi_{y} (1 + \epsilon, 0) &amp;= 0 , \\
\psi_{y} (1 - \epsilon, 0) &amp;= 0 , \\
\psi_{x} (1 - \delta \epsilon, \kappa \epsilon) &amp;= 0 , \\
\psi_{x} (x_{\mathrm{sep}}, y_{\mathrm{sep}}) &amp;= 0 , \\
\psi_{y} (x_{\mathrm{sep}}, y_{\mathrm{sep}}) &amp;= 0 , \\
\psi_{yy} (1 + \epsilon, 0) &amp;= - N_1 \psi_{x} (1 + \epsilon, 0) , \\
\psi_{yy} (1 - \epsilon, 0) &amp;= - N_2 \psi_{x} (1 - \epsilon, 0) , \\
\psi_{xx} (1 - \delta \epsilon, \kappa \epsilon) &amp;= - N_3 \psi_y (1 - \delta \epsilon, \kappa \epsilon) .
\end{aligned}\]</div><p>The first four equations define the four test points, the fifth and sixth equations define the up-down symmetry, the seventh equations enforces the high point to be a maximum, the eighth and ninth eqaution set the <span>$x$</span>- and <span>$y$</span>-components of the magnetic field at the X-point to zero, and the last three equations define the curvature at the first three test points.</p><p>The coefficients <span>$N_j$</span> can be found from the analytic model cross section as</p><div>\[\begin{aligned}
N_1 &amp;= \left[ \frac{d^2 x}{dy^2} \right]_{\tau = 0}     = - \frac{(1 + \delta_0)^2}{\epsilon \kappa^2} , \\
N_2 &amp;= \left[ \frac{d^2 x}{dy^2} \right]_{\tau = \pi}   = \hphantom{-} \frac{(1 - \delta_0)^2}{\epsilon \kappa^2} , \\
N_3 &amp;= \left[ \frac{d^2 x}{dy^2} \right]_{\tau = \pi/2} = - \frac{\kappa}{\epsilon \, \cos^2 \delta_0} .
\end{aligned}\]</div><p>For a given value of the constant <span>$a$</span> above conditions reduce to a set of seven linear inhomogeneous algebraic equations for the unknown <span>$c_i$</span>, which can easily be solved.</p><p>Parameters:</p><ul><li><code>R₀</code>: position of magnetic axis</li><li><code>B₀</code>: B-field at magnetic axis</li><li><code>ϵ</code>:  inverse aspect ratio</li><li><code>κ</code>:  elongation</li><li><code>δ</code>:  triangularity</li><li><code>α</code>:  free constant, determined to match a given beta value</li><li><code>xsep</code>: x position of the X point</li><li><code>ysep</code>: y position of the X point</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/ElectromagneticFields.jl/blob/56ffa5c7b3d5839dec8fec88d1a2094055a27f49/src/analytic/solovev.jl#L237-L335">source</a></section></article><p>Vector potential in ITER and NSTX:</p><p><img src="../solovev_xpoint.png" alt/></p><h2 id="Theta-Pinch"><a class="docs-heading-anchor" href="#Theta-Pinch">Theta Pinch</a><a id="Theta-Pinch-1"></a><a class="docs-heading-anchor-permalink" href="#Theta-Pinch" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ElectromagneticFields.ThetaPinch" href="#ElectromagneticFields.ThetaPinch"><code>ElectromagneticFields.ThetaPinch</code></a> — <span class="docstring-category">Module</span></header><section><div><p>θ-pinch equilibrium in (x,y,z) coordinates with covariant components of the vector potential given by</p><div>\[A (x,y,z) = \frac{B_0}{2} \big( - y , \, x , \, 0 \big)^T\]</div><p>resulting in the magnetic field with covariant components</p><div>\[B (x,y,z) = \big( 0 , \, 0 , \, B_0 \big)^T .\]</div><p>Parameters:     B₀: B-field at magnetic axis</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/DDMGNI/ElectromagneticFields.jl/blob/56ffa5c7b3d5839dec8fec88d1a2094055a27f49/src/analytic/theta_pinch.jl#L1-L14">source</a></section></article><p>Vector potential components:</p><p><img src="../theta_pinch.png" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../modules/">Modules »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 13 October 2020 07:15">Tuesday 13 October 2020</span>. Using Julia version 1.5.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
